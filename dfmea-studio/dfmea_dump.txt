DFMEA STUDIO SOURCE DUMP
Generated: 2026-01-26 12:38:53
Root: D:\dfmeav7_onlyfrontend\dfmea-studio

Included paths:
 - src\components
 - src\contexts
 - src\App.jsx

Files:
 - src\App.jsx
 - src\components\AiDock.jsx
 - src\components\RequirementsViewport.jsx
 - src\components\Sidebar.jsx
 - src\components\TasksViewport.jsx
 - src\components\TopNav.jsx
 - src\components\Workspace.jsx
 - src\contexts\DFMEAContext.jsx

==========================================================================================
FILE: src\App.jsx
==========================================================================================
import TopNav from "./components/TopNav";
import Sidebar from "./components/Sidebar";
import Workspace from "./components/Workspace";
import { DFMEAProvider } from "./contexts/DFMEAContext";

export default function App() {
  return (
    <DFMEAProvider>
      <div className="h-screen bg-[#fbfbfa] text-zinc-900 antialiased">
        <div className="lg:hidden h-screen flex items-center justify-center p-8">
          <div className="max-w-md text-center">
            <div className="text-xl font-semibold tracking-tight">Desktop required</div>
            <div className="mt-2 text-sm text-zinc-600">
              This mock UI is designed strictly for desktop layouts.
            </div>
          </div>
        </div>

        <div className="hidden lg:flex h-full flex-col overflow-hidden">
          <TopNav />
          <div className="flex flex-1 overflow-hidden">
            <Sidebar />
            <Workspace />
          </div>
        </div>
      </div>
    </DFMEAProvider>
  );
}

==========================================================================================
FILE: src\components\AiDock.jsx
==========================================================================================
"use client";
import { useEffect, useRef, useState } from "react";

export default function AiDock() {
  const [input, setInput] = useState("");
  const [messages, setMessages] = useState([{ role: "assistant", text: "Hey — I'm your AI assistant (mock)." }]);
  const [full, setFull] = useState(false);
  const listRef = useRef(null);
  const inputRef = useRef(null);

  useEffect(() => {
    if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;
  }, [messages]);

  const send = () => {
    const t = input.trim();
    if (!t) return;
    setMessages([...messages, { role: "user", text: t }, { role: "assistant", text: "Mock response (wire to LLM later)." }]);
    setInput("");
    setTimeout(() => inputRef.current?.focus(), 0);
  };

  return (
    <>
      {full && <div className="fixed inset-0 bg-black/40 backdrop-blur-sm z-40" onClick={() => setFull(false)} />}
      <div className={full ? "fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[80%] h-[80%] bg-white z-50 flex flex-col rounded-2xl shadow-2xl border border-zinc-200/80" : "fixed bottom-4 left-1/2 -translate-x-1/2 w-1/2 min-w-[400px] bg-white rounded-2xl shadow-2xl border border-zinc-200/80 flex flex-col"} style={!full ? { height: messages.length <= 1 ? '140px' : '280px' } : {}}>
        
        {/* Header */}
        <div className="px-4 py-2.5 border-b border-zinc-200/60 flex-shrink-0 flex items-center justify-between">
          <span className="text-xs font-medium text-zinc-600">AI assistant (mock)</span>
          <button onClick={() => setFull(!full)} className="text-[11px] px-2.5 py-1 rounded-xl bg-white border border-zinc-200/80 text-zinc-700 hover:bg-zinc-50">
            {full ? "Close" : "Full"}
          </button>
        </div>
        
        {/* Messages */}
        <div ref={listRef} className="flex-1 overflow-y-auto px-4 py-2 space-y-2">
          {messages.map((m, i) => (
            <div key={i} className={m.role === "user" ? "text-right" : ""}>
              <span className={`inline-block text-[12px] px-3 py-1.5 rounded-xl ${m.role === "user" ? "bg-blue-500 text-white" : "bg-zinc-100 text-zinc-800"}`}>
                {m.text}
              </span>
            </div>
          ))}
        </div>
        
        {/* Input */}
        <div className="px-4 py-3 border-t border-zinc-200/60 flex-shrink-0">
          <div className="flex items-center gap-2">
            <input 
              ref={inputRef}
              value={input} 
              onChange={(e) => setInput(e.target.value)} 
              onKeyDown={(e) => e.key === "Enter" && send()} 
              placeholder="Type…" 
              className="flex-1 text-[12px] px-3 py-2 rounded-xl border border-zinc-200/80 outline-none placeholder:text-zinc-400" 
            />
            <button onClick={send} className="text-[11px] px-4 py-2 rounded-xl bg-blue-500 text-white hover:bg-blue-600">
              Send
            </button>
          </div>
        </div>
      </div>
    </>
  );
}

==========================================================================================
FILE: src\components\RequirementsViewport.jsx
==========================================================================================
import { useState } from "react";
import {
  Cpu,
  Zap,
  Wrench,
  Paperclip,
  CheckCircle2,
  AlertTriangle,
  LayoutGrid,
  List,
  Minus,
  Plus,
} from "lucide-react";
import { useRequirements } from "../hooks/useRequirements";
import { useRequirementGrouping } from "../hooks/useRequirementGrouping";

const ICONS = { Software: Cpu, Electrical: Zap, Mechanical: Wrench };

const Pill = ({ tone = "neutral", children }) => (
  <span
    className={`text-[11px] px-2 py-1 rounded-full border tracking-tight ${
      tone === "bad"
        ? "bg-amber-50 border-amber-200/70 text-amber-900"
        : tone === "good"
        ? "bg-emerald-50 border-emerald-200/70 text-emerald-900"
        : "bg-[#fbfbfa] border-zinc-200/80 text-zinc-700"
    }`}
  >
    {children}
  </span>
);

const Btn = ({ active, disabled, onClick, children }) => (
  <button
    onClick={onClick}
    disabled={disabled}
    className={`inline-flex items-center gap-1 text-[11px] px-2.5 py-1.5 rounded-xl border tracking-tight transition-colors ${
      active
        ? "bg-zinc-900 text-white border-zinc-900"
        : disabled
        ? "bg-white border-zinc-200/60 text-zinc-300 cursor-not-allowed"
        : "bg-white border-zinc-200/80 text-zinc-700 hover:bg-zinc-100"
    }`}
  >
    {children}
  </button>
);

export default function RequirementsViewport() {
  const { projectName, requirements, frozen, stats } = useRequirements();

  const [view, setView] = useState("cards");
  const [size, setSize] = useState("md");
  const [filter, setFilter] = useState("all");

  const { buckets, filtered } = useRequirementGrouping(requirements, { frozenFn: frozen, filter });

  const grid =
    size === "xs"
      ? "grid-cols-5 gap-3"
      : size === "sm"
      ? "grid-cols-4 gap-3"
      : size === "lg"
      ? "grid-cols-2 gap-4"
      : "grid-cols-3 gap-4";

  const pad = size === "xs" || size === "sm" ? "p-3" : size === "lg" ? "p-5" : "p-4";

  return (
    <div className="pb-24">
      <div className="max-w-6xl mx-auto px-10 pt-12 pb-5">
        <div className="flex items-start justify-between gap-6">
          <div>
            <div className="text-[40px] leading-[1.12] font-semibold tracking-tight">Requirements</div>
            <div className="mt-2 text-[13px] text-zinc-600">
              Project • <span className="text-zinc-900 font-medium">{projectName}</span>
            </div>
          </div>

          <div className="pt-2 flex items-center gap-2">
            <Pill tone={stats.frozen === stats.total ? "good" : "bad"}>
              <span className="inline-flex items-center gap-1.5">
                {stats.frozen === stats.total ? <CheckCircle2 size={12} /> : <AlertTriangle size={12} />}
                {stats.frozen}/{stats.total} frozen
              </span>
            </Pill>

            <Pill tone={stats.flagged ? "bad" : "good"}>
              <span className="inline-flex items-center gap-1.5">
                <AlertTriangle size={12} /> {stats.flagged} flagged
              </span>
            </Pill>

            <div className="ml-2 flex gap-1.5">
              {[
                ["all", "All"],
                ["unfrozen", "Unfrozen"],
                ["frozen", "Frozen"],
              ].map(([m, l]) => (
                <Btn key={m} active={filter === m} onClick={() => setFilter(m)}>
                  {l}
                </Btn>
              ))}
            </div>

            <div className="ml-2 flex gap-1.5">
              <Btn active={view === "cards"} onClick={() => setView("cards")}>
                <LayoutGrid size={14} /> Cards
              </Btn>
              <Btn active={view === "list"} onClick={() => setView("list")}>
                <List size={14} /> List
              </Btn>
              <div className="w-px h-6 bg-zinc-200/80 mx-1" />
              <Btn onClick={() => setSize((s) => (s === "lg" ? "md" : s === "md" ? "sm" : "xs"))} disabled={view !== "cards"}>
                <Minus size={14} />
              </Btn>
              <Btn onClick={() => setSize((s) => (s === "xs" ? "sm" : s === "sm" ? "md" : "lg"))} disabled={view !== "cards"}>
                <Plus size={14} />
              </Btn>
            </div>
          </div>
        </div>
      </div>

      <div className="max-w-6xl mx-auto px-10 space-y-5">
        {buckets.order.map((d) => {
          const list = filtered[d] || [];
          if (!list.length) return null;

          const full = buckets.map[d] || [];
          const Icon = ICONS[d] || Cpu;

          const uf = full.filter((r) => !frozen(r)).length;
          const fg = full.filter((r) => r.flagged).length;

          return (
            <div
              key={d}
              className="rounded-xl border border-zinc-200/80 bg-white shadow-[0_1px_0_rgba(0,0,0,0.05),0_14px_40px_rgba(0,0,0,0.06)]"
            >
              <div className="px-4 py-3 border-b border-zinc-200/70 bg-[#fbfbfa] flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <div className="h-8 w-8 rounded-xl border border-zinc-200/80 bg-white grid place-items-center">
                    <Icon size={16} strokeWidth={1.8} className="text-zinc-800" />
                  </div>
                  <div>
                    <div className="text-[12px] font-semibold text-zinc-900">{d}</div>
                    <div className="text-[11px] text-zinc-500">
                      {uf} unfrozen • {fg} flagged • {full.length} total
                    </div>
                  </div>
                </div>
                <div className="flex gap-2">
                  <Pill tone={uf ? "bad" : "good"}>{uf} unfrozen</Pill>
                  <Pill tone={fg ? "bad" : "good"}>{fg} flagged</Pill>
                </div>
              </div>

              {view === "cards" ? (
                <div className={`p-4 grid ${grid}`}>
                  {list.map((r) => (
                    <div
                      key={r.id}
                      className={`rounded-2xl border border-zinc-200/80 bg-white shadow-[0_1px_0_rgba(0,0,0,0.05),0_10px_24px_rgba(0,0,0,0.06)] ${pad}`}
                    >
                      <div className="flex items-start justify-between gap-3">
                        <div>
                          <div className="flex items-center gap-2">
                            <div className="text-[11px] text-zinc-500">{r.id}</div>
                            {frozen(r) ? (
                              <CheckCircle2 size={14} className="text-zinc-900" />
                            ) : r.flagged ? (
                              <AlertTriangle size={14} className="text-zinc-900" />
                            ) : (
                              <AlertTriangle size={14} className="text-zinc-600" />
                            )}
                          </div>
                          <div className="mt-1 text-[13px] font-semibold text-zinc-900 line-clamp-2">{r.text}</div>
                        </div>
                      </div>

                      <div className="mt-3 flex flex-wrap gap-2">
                        <Pill>
                          <span className="inline-flex items-center gap-1.5">
                            <div className="h-1.5 w-1.5 rounded-full bg-zinc-900/70" />
                            {r.reqType}
                          </span>
                        </Pill>
                        <Pill>{r.priority}</Pill>
                        <Pill tone={frozen(r) ? "good" : "neutral"}>
                          {frozen(r) ? "Frozen" : r.flagged ? "Flagged" : "Incomplete"}
                        </Pill>
                      </div>

                      <div className="mt-3 flex items-center justify-between text-[11px] text-zinc-500">
                        <div>
                          {r.ownerRole} • {r.ownerName}
                        </div>
                        <div className="flex items-center gap-2">
                          <Paperclip size={14} strokeWidth={1.7} />
                          {r.files?.length ?? 0}
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              ) : (
                <div>
                  <div className="grid grid-cols-12 text-[11px] font-medium text-zinc-500 bg-[#fbfbfa] border-b border-zinc-200/70">
                    <div className="col-span-2 px-5 py-3">ID</div>
                    <div className="col-span-5 px-5 py-3">Requirement</div>
                    <div className="col-span-2 px-5 py-3">Owner</div>
                    <div className="col-span-2 px-5 py-3">Status</div>
                    <div className="col-span-1 px-5 py-3 text-right">Files</div>
                  </div>

                  {list.map((r) => (
                    <div
                      key={r.id}
                      className="grid grid-cols-12 text-[13px] border-b last:border-b-0 border-zinc-200/60 hover:bg-[#fbfbfa] transition-colors"
                    >
                      <div className="col-span-2 px-5 py-3 text-zinc-600 flex items-center gap-2">
                        <span>{r.id}</span>
                        {frozen(r) ? (
                          <CheckCircle2 size={14} className="text-zinc-900" />
                        ) : r.flagged ? (
                          <AlertTriangle size={14} className="text-zinc-900" />
                        ) : (
                          <AlertTriangle size={14} className="text-zinc-600" />
                        )}
                      </div>

                      <div className="col-span-5 px-5 py-3">
                        <div className="text-zinc-900 leading-snug">{r.text}</div>
                        <div className="mt-2 flex flex-wrap gap-2">
                          <Pill>
                            <span className="inline-flex items-center gap-1.5">
                              <div className="h-1.5 w-1.5 rounded-full bg-zinc-900/70" />
                              {r.reqType}
                            </span>
                          </Pill>
                          <Pill tone={frozen(r) ? "good" : r.flagged ? "bad" : "neutral"}>
                            {frozen(r) ? "Frozen" : r.flagged ? "Flagged" : "Incomplete"}
                          </Pill>
                        </div>
                      </div>

                      <div className="col-span-2 px-5 py-3 text-zinc-600">
                        <div className="text-zinc-900">{r.ownerRole}</div>
                        <div className="mt-0.5 text-[11px] text-zinc-500">Added by {r.ownerName}</div>
                      </div>

                      <div className="col-span-2 px-5 py-3 text-zinc-600">
                        <div className="text-zinc-900">{r.priority}</div>
                        <div className="mt-0.5 text-[11px] text-zinc-500">
                          {frozen(r) ? "Frozen" : r.flagged ? "Flagged" : "Incomplete"}
                        </div>
                      </div>

                      <div className="col-span-1 px-5 py-3 text-right text-zinc-600 flex items-center justify-end gap-2">
                        <Paperclip size={14} strokeWidth={1.7} className="text-zinc-500" />
                        {r.files?.length ?? 0}
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          );
        })}
      </div>
    </div>
  );
}

==========================================================================================
FILE: src\components\Sidebar.jsx
==========================================================================================
"use client";
import { useState } from "react";
import { Home, CalendarDays, Sparkles, Inbox, Settings, Trash2, Search, ChevronDown, GitBranch, Plus, ClipboardList } from "lucide-react";
import { useAppNavigation } from "../hooks/useAppNavigation";
import { useTasks } from "../hooks/useTasks";
import { useWorkflows } from "../hooks/useWorkflows";

const Item = ({ icon: Icon, label, active, onClick, right, sub }) => (
  <div onClick={onClick} className={`group flex items-center gap-2 px-2 py-1.5 rounded-md cursor-pointer transition-colors hover:bg-zinc-200/40 text-zinc-700 ${sub ? "pl-7 text-[12px]" : "text-[13px] font-medium"} ${active ? "bg-zinc-200/50 text-zinc-900" : ""}`}>
    {Icon && <Icon size={16} strokeWidth={1.7} />}
    <span className="flex-1 truncate">{label}</span>
    {right}
  </div>
);

const Chev = ({ is }) => <ChevronDown size={16} className={`text-zinc-500 transition-transform ${is ? "" : "-rotate-90"}`} />;

export default function Sidebar() {
  const { activeTab, setActiveTab } = useAppNavigation();
  const { tasks } = useTasks();
  const { workflows, selectedWorkflowId, setSelectedWorkflowId, createWorkflow, deleteWorkflow } = useWorkflows();
  const [open, setOpen] = useState({ workflows: false, inbox: false });

  return (
    <aside className="w-[280px] h-full bg-[#f5f5f3] border-r border-zinc-200/70 flex flex-col p-3 gap-2">
      <div className="flex items-center gap-3 px-2 py-2 rounded-md hover:bg-zinc-200/40 transition-colors cursor-pointer">
        <div className="h-8 w-8 rounded-xl bg-white border border-zinc-200/80 flex items-center justify-center text-xs font-bold text-zinc-800">IA</div>
        <div className="min-w-0 leading-tight">
          <div className="text-[13px] font-semibold text-zinc-900 truncate">Mechanical Engineer</div>
          <div className="text-[11px] text-zinc-500 truncate">Workspace • mock</div>
        </div>
      </div>

      <div className="px-2">
        <div className="rounded-md bg-white border border-zinc-200/80 px-2.5 py-2 flex items-center gap-2">
          <Search size={16} className="text-zinc-400" />
          <input className="w-full text-[13px] outline-none bg-transparent placeholder:text-zinc-400" placeholder="Search" disabled />
        </div>
      </div>

      <nav className="flex-1 overflow-y-auto space-y-0.5 px-2">
        <Item icon={Home} label="Home" active={activeTab === "home"} onClick={() => setActiveTab("home")} />
        <Item icon={CalendarDays} label="Meetings" active={activeTab === "meetings"} onClick={() => setActiveTab("meetings")} />
        <Item icon={Sparkles} label="Notion AI" active={activeTab === "ai"} onClick={() => setActiveTab("ai")} />

        <Item icon={Inbox} label="Inbox" active={open.inbox} onClick={() => setOpen((p) => ({ ...p, inbox: !p.inbox }))} right={<Chev is={open.inbox} />} />
        {open.inbox && <Item sub label="Manager view" active={false} onClick={() => {}} right={<span className="text-[10px] px-1.5 py-0.5 rounded-full border bg-white text-zinc-500">Read-only</span>} />}

        <Item icon={GitBranch} label="Workflows" active={open.workflows} onClick={() => setOpen((p) => ({ ...p, workflows: !p.workflows }))} right={<Chev is={open.workflows} />} />
        {open.workflows && (
          <div className="space-y-0.5">
            {workflows.map((w) => (
              <Item key={w.id} sub label={w.title || "Untitled"} active={selectedWorkflowId === w.id && activeTab === "workflows"} onClick={() => { setActiveTab("workflows"); setSelectedWorkflowId(w.id); }} right={<Trash2 size={14} className="opacity-0 group-hover:opacity-100 hover:text-red-600 transition-opacity" onClick={(e) => { e.stopPropagation(); if (confirm("Delete?")) deleteWorkflow(w.id); }} />} />
            ))}
            <button onClick={createWorkflow} className="w-full pl-7 py-1.5 flex items-center gap-2 text-[12px] text-zinc-500 hover:bg-zinc-200/40 rounded-md transition-colors">
              <Plus size={14} /> Add workflow
            </button>
          </div>
        )}

        <div className="mt-6">
          <div className="flex items-center justify-between mb-2 text-[11px] font-medium text-zinc-500 uppercase tracking-wider px-2">
            Tasks
            <button onClick={() => setActiveTab("tasks")} className="h-6 px-2 rounded border bg-white hover:bg-zinc-50 flex items-center gap-1 text-zinc-700">
              <ClipboardList size={12} /> View
            </button>
          </div>

          {tasks.length ? (
            tasks.slice(0, 3).map((t) => (
              <div key={t.id} className={`px-2 py-1.5 text-[13px] hover:bg-zinc-200/40 rounded-md transition-colors truncate ${t.status === "done" ? "text-zinc-400 line-through" : "text-zinc-800"}`}>
                {t.title}
              </div>
            ))
          ) : (
            <div className="text-[12px] text-zinc-400 px-2 py-2">No tasks found.</div>
          )}
        </div>
      </nav>

      <div className="pt-4 border-t border-zinc-200/50 px-2 space-y-0.5">
        <Item icon={Settings} label="Settings" />
        <Item icon={Trash2} label="Trash" />
      </div>
    </aside>
  );
}

==========================================================================================
FILE: src\components\TasksViewport.jsx
==========================================================================================
import { useState } from "react";
import {
  CheckCircle2,
  AlertTriangle,
  Clock,
  Search,
  LayoutPanelTop,
  LayoutGrid,
  LayoutPanelLeft,
  Maximize2,
} from "lucide-react";

import { useTasks } from "../hooks/useTasks";
import { useTaskFiltering } from "../hooks/useTaskFiltering";
import { useTimelineLayout } from "../hooks/useTimelineLayout";

const STATUS = {
  done: { label: "Done", tone: "good", icon: CheckCircle2, bar: "bg-emerald-500" },
  blocked: { label: "Blocked", tone: "bad", icon: AlertTriangle, bar: "bg-amber-500" },
  active: { label: "In Progress", tone: "neutral", icon: Clock, bar: "bg-blue-500" },
  todo: { label: "To do", tone: "neutral", icon: Clock, bar: "bg-zinc-600" },
};

const Pill = ({ tone, children }) => (
  <span
    className={`text-[11px] px-2.5 py-1 rounded-full border flex items-center gap-1.5 font-medium ${
      tone === "good"
        ? "bg-emerald-50 border-emerald-200 text-emerald-700"
        : tone === "bad"
        ? "bg-amber-50 border-amber-200 text-amber-700"
        : "bg-white border-zinc-200 text-zinc-600 shadow-sm"
    }`}
  >
    {children}
  </span>
);

export default function TasksViewport() {
  const { tasks, lanes, milestones, range, project, stats } = useTasks();

  const [q, setQ] = useState("");
  const [statusFilter, setStatusFilter] = useState("all");
  const [viewMode, setViewMode] = useState("split");

  const { filtered, count } = useTaskFiltering(tasks, { q, statusFilter });

  const pxPerDay = 40;
  const { timelineWidth, dayCount, getLeft, getWidth, lanesPacked } = useTimelineLayout({
    range,
    pxPerDay,
    lanes,
    tasks: filtered,
  });

  const split =
    viewMode === "timeline"
      ? { left: 30, right: 70 }
      : viewMode === "split"
      ? { left: 45, right: 55 }
      : viewMode === "tasks"
      ? { left: 65, right: 35 }
      : { left: 0, right: 100 };

  return (
    <div className="h-screen flex flex-col bg-zinc-50 overflow-hidden font-sans text-zinc-900">
      <div className="px-8 pt-8 pb-4 shrink-0">
        <div className="flex items-start justify-between gap-6 mb-6">
          <div>
            <h1 className="text-3xl font-bold tracking-tight text-zinc-900">Tasks</h1>
            <p className="mt-1 text-sm text-zinc-500">
              Project • <span className="font-medium text-zinc-900">{project}</span>
            </p>
          </div>
          <div className="flex gap-2">
            <Pill tone="good">
              <CheckCircle2 size={12} /> {stats.done} done
            </Pill>
            <Pill tone={stats.blocked ? "bad" : "neutral"}>
              <AlertTriangle size={12} /> {stats.blocked} blocked
            </Pill>
            <Pill>
              <Clock size={12} /> {stats.active} active
            </Pill>
          </div>
        </div>

        <div className="rounded-2xl border border-zinc-200/80 bg-white p-2 shadow-sm flex items-center justify-between gap-4">
          <div className="flex items-center gap-3 flex-1">
            <div className="relative flex-1 max-w-sm ml-1">
              <Search size={14} className="absolute left-3 top-1/2 -translate-y-1/2 text-zinc-400" />
              <input
                value={q}
                onChange={(e) => setQ(e.target.value)}
                placeholder="Search tasks..."
                className="w-full pl-9 pr-3 py-1.5 text-sm rounded-lg bg-zinc-50 border-transparent focus:bg-white focus:ring-2 ring-zinc-100 outline-none transition-all placeholder:text-zinc-400"
              />
            </div>

            <select
              value={statusFilter}
              onChange={(e) => setStatusFilter(e.target.value)}
              className="text-sm px-3 py-1.5 rounded-lg bg-zinc-50 border-transparent hover:bg-zinc-100 cursor-pointer outline-none font-medium text-zinc-600"
            >
              <option value="all">All Status</option>
              {Object.keys(STATUS).map((k) => (
                <option key={k} value={k}>
                  {STATUS[k].label}
                </option>
              ))}
            </select>
          </div>

          <div className="flex bg-zinc-100 p-1 rounded-xl">
            {[
              { id: "timeline", icon: LayoutPanelTop, label: "Timeline" },
              { id: "split", icon: LayoutGrid, label: "Split" },
              { id: "tasks", icon: LayoutPanelLeft, label: "List" },
              { id: "full", icon: Maximize2, label: "Full" },
            ].map((m) => (
              <button
                key={m.id}
                onClick={() => setViewMode(m.id)}
                className={`px-3 py-1.5 rounded-lg text-[11px] font-medium inline-flex items-center gap-1.5 transition-all ${
                  viewMode === m.id ? "bg-white text-zinc-900 shadow-sm" : "text-zinc-500 hover:text-zinc-900"
                }`}
              >
                <m.icon size={14} /> {m.label}
              </button>
            ))}
          </div>
        </div>
      </div>

      <div className="flex-1 min-h-0 px-8 pb-8 flex gap-6 overflow-hidden">
        {viewMode !== "full" && split.left > 0 && (
          <div style={{ width: `${split.left}%` }} className="flex flex-col min-w-[320px] transition-all duration-300">
            <div className="h-full rounded-2xl border border-zinc-200 bg-white shadow-sm flex flex-col overflow-hidden">
              <div className="px-5 py-4 border-b border-zinc-100 bg-zinc-50/50 flex justify-between items-center">
                <span className="text-xs font-bold uppercase tracking-wider text-zinc-400">Task List</span>
                <span className="text-[11px] font-medium px-2 py-0.5 rounded-md bg-zinc-100 text-zinc-500">{count} tasks</span>
              </div>

              <div className="flex-1 overflow-y-auto">
                {filtered.map((t) => {
                  const S = STATUS[t.status] || STATUS.todo;
                  return (
                    <div
                      key={t.id}
                      className="group border-b border-zinc-50 last:border-0 px-5 py-3.5 hover:bg-zinc-50 transition-colors cursor-pointer"
                    >
                      <div className="flex items-start justify-between mb-1.5">
                        <span className="font-mono text-[10px] text-zinc-400">{t.id}</span>
                        <div
                          className={`flex items-center gap-1 text-[10px] font-bold px-1.5 py-0.5 rounded uppercase tracking-wide ${
                            S.tone === "good"
                              ? "bg-emerald-50 text-emerald-700"
                              : S.tone === "bad"
                              ? "bg-amber-50 text-amber-700"
                              : "bg-zinc-100 text-zinc-500"
                          }`}
                        >
                          <S.icon size={10} strokeWidth={3} /> {S.label}
                        </div>
                      </div>

                      <div className="text-[13px] font-semibold text-zinc-900 mb-2">{t.title}</div>

                      <div className="flex items-center justify-between text-xs text-zinc-500">
                        <span className="font-medium">{t.owner}</span>
                        <div className="flex items-center gap-2">
                          <span className="text-[10px]">{t.progress}%</span>
                          <div className="w-12 h-1 bg-zinc-100 rounded-full overflow-hidden">
                            <div className="h-full bg-zinc-800 rounded-full" style={{ width: `${t.progress}%` }} />
                          </div>
                        </div>
                      </div>
                    </div>
                  );
                })}
                {!filtered.length && <div className="text-[12px] text-zinc-400 p-5">No matching tasks.</div>}
              </div>
            </div>
          </div>
        )}

        <div style={{ width: `${split.right}%` }} className="flex-1 min-w-0 flex flex-col transition-all duration-300">
          <div className="h-full rounded-2xl border border-zinc-200 bg-white shadow-sm flex flex-col overflow-hidden">
            <div className="px-5 py-4 border-b border-zinc-200 bg-zinc-50/50 flex items-center justify-between shrink-0">
              <div className="text-xs font-bold uppercase tracking-wider text-zinc-400">Timeline</div>
              <div className="flex gap-4 text-xs text-zinc-500 font-medium">
                <span>
                  {range.start} → {range.end}
                </span>
                <span className="px-2 py-0.5 bg-white border border-zinc-200 rounded">{dayCount} days</span>
              </div>
            </div>

            <div className="flex-1 overflow-auto relative bg-white">
              <div className="min-w-max">
                <div className="sticky top-0 z-20 flex bg-white border-b border-zinc-200 h-9 shadow-[0_1px_2px_rgba(0,0,0,0.02)]">
                  <div className="w-52 shrink-0 border-r border-zinc-100 bg-zinc-50/80 flex items-center px-5 text-xs font-semibold text-zinc-400">
                    Lanes
                  </div>

                  <div className="relative flex-1" style={{ width: timelineWidth }}>
                    <div
                      className="absolute inset-0 w-full h-full"
                      style={{
                        backgroundImage: "linear-gradient(to right, #f4f4f5 1px, transparent 1px)",
                        backgroundSize: `${pxPerDay}px 100%`,
                      }}
                    />

                    {milestones.map((m) => (
                      <div
                        key={m.id}
                        className={`absolute top-2 px-2 py-0.5 rounded text-[9px] font-bold text-white shadow-sm transform -translate-x-1/2 ${m.color}`}
                        style={{ left: getLeft(m.date) }}
                      >
                        {m.title}
                      </div>
                    ))}
                  </div>
                </div>

                <div className="relative">
                  <div
                    className="absolute inset-0 pointer-events-none"
                    style={{
                      left: 208,
                      width: timelineWidth,
                      backgroundImage: "linear-gradient(to right, #f4f4f5 1px, transparent 1px)",
                      backgroundSize: `${pxPerDay}px 100%`,
                    }}
                  />

                  {lanesPacked.map(({ lane, packed, rowsCount }) => {
                    return (
                      <div key={lane.id} className="flex border-b border-zinc-100 hover:bg-zinc-50/40 relative">
                        <div className="w-52 shrink-0 p-4 border-r border-zinc-100 bg-white sticky left-0 z-10">
                          <div className="text-sm font-semibold text-zinc-900">{lane.title}</div>
                          <div className="text-xs text-zinc-500 mt-0.5">{lane.group}</div>
                        </div>

                        <div className="relative py-4" style={{ height: Math.max(80, rowsCount * 34 + 32) }}>
                          {packed.map((t) => (
                            <div
                              key={t.id}
                              className={`absolute h-[26px] rounded-lg border border-white/20 shadow-sm flex items-center px-2.5 hover:brightness-110 hover:shadow-md hover:z-20 hover:scale-[1.02] transition-all cursor-pointer overflow-hidden ${
                                (STATUS[t.status] || STATUS.todo).bar
                              }`}
                              style={{
                                left: getLeft(t.start),
                                top: t.row * 32,
                                width: getWidth(t.start, t.end),
                              }}
                              title={`${t.title} (${t.progress}%)`}
                            >
                              <div className="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent" />
                              <div
                                className="absolute inset-0 bg-black/10"
                                style={{ width: `${100 - t.progress}%`, left: `${t.progress}%` }}
                              />
                              <span className="relative z-10 text-[11px] font-medium text-white truncate drop-shadow-sm">
                                {t.title}
                              </span>
                            </div>
                          ))}
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  );
}

==========================================================================================
FILE: src\components\TopNav.jsx
==========================================================================================
import { Search, Bell } from "lucide-react";
import { useAppNavigation } from "../hooks/useAppNavigation";

export default function TopNav() {
  const { activeTab, setActiveTab } = useAppNavigation();

  const label = activeTab === "tasks" ? "Tasks" : "Requirements";

  return (
    <div className="h-14 px-5 flex items-center justify-between bg-[#fbfbfa] border-b border-zinc-200/70">
      <div className="grid grid-cols-[280px_1fr] items-center gap-4">
        <div className="flex items-center gap-3">
          <div className="h-8 w-8 rounded-xl bg-zinc-900 text-white flex items-center justify-center text-xs font-semibold">
            DF
          </div>
          <div className="min-w-0">
            <div className="text-[13px] font-semibold text-zinc-900 truncate">DFMEA Studio</div>
            <div className="text-[11px] text-zinc-500 truncate">
              Desktop mock • <span className="text-zinc-700">{label}</span>
            </div>
          </div>
        </div>

        <div className="hidden lg:flex items-center gap-1 bg-white rounded-xl p-1 border border-zinc-200/80">
          <button
            onClick={() => setActiveTab("requirements")}
            className={`text-[13px] px-3 py-1.5 rounded-lg font-medium ${
              activeTab === "requirements" ? "text-white bg-zinc-900" : "text-zinc-700 hover:bg-zinc-100"
            }`}
          >
            Requirements
          </button>
          <button
            onClick={() => setActiveTab("tasks")}
            className={`text-[13px] px-3 py-1.5 rounded-lg font-medium ${
              activeTab === "tasks" ? "text-white bg-zinc-900" : "text-zinc-700 hover:bg-zinc-100"
            }`}
          >
            Tasks
          </button>
        </div>
      </div>

      <div className="flex items-center gap-3">
        <div className="hidden xl:flex items-center gap-2 bg-white rounded-xl px-3 py-2 border border-zinc-200/80">
          <Search size={18} strokeWidth={1.6} className="text-zinc-600" />
          <input
            className="w-64 text-[13px] outline-none placeholder:text-zinc-400 bg-transparent"
            placeholder="Search (mock)"
            disabled
          />
        </div>

        <button disabled className="h-10 w-10 rounded-xl bg-white border border-zinc-200/80 grid place-items-center opacity-70">
          <Bell size={18} strokeWidth={1.6} className="text-zinc-700" />
        </button>

        <button disabled className="text-[13px] font-medium px-3.5 py-2 rounded-xl bg-zinc-900 text-white opacity-70">
          Share
        </button>
      </div>
    </div>
  );
}

==========================================================================================
FILE: src\components\Workspace.jsx
==========================================================================================
import { FileText, CalendarDays } from "lucide-react";
import RequirementsViewport from "./RequirementsViewport";
import TasksViewport from "./TasksViewport";
import AiDock from "./AiDock";
import { useAppNavigation } from "../hooks/useAppNavigation";
import { useRequirements } from "../hooks/useRequirements";
import { useTasks } from "../hooks/useTasks";
import { useDockHeightPadding } from "../hooks/useDockHeightPadding";

export default function Workspace() {
  const { activeTab } = useAppNavigation();
  const { meta: reqMeta, requirementsData } = useRequirements();
  const { meta: tasksMeta, tasksData } = useTasks();

  const { dockRef, dockHeight } = useDockHeightPadding();

  const isTasks = activeTab === "tasks";
  const currentTitle = isTasks ? tasksData?.title || "Tasks" : requirementsData?.title || "Requirements";
  const Icon = isTasks ? CalendarDays : FileText;

  const visibility = isTasks ? tasksMeta?.visibility : reqMeta?.visibility;
  const edited = isTasks ? tasksMeta?.edited : reqMeta?.edited;

  return (
    <div className="flex-1 min-w-0 overflow-hidden bg-[#fbfbfa]">
      <div className="h-full flex flex-col">
        <div className="h-12 px-6 flex items-center justify-between bg-[#fbfbfa] border-b border-zinc-200/70">
          <div className="flex items-center gap-2 min-w-0">
            <Icon size={18} strokeWidth={1.6} className="text-zinc-700" />
            <div className="text-[13px] font-semibold tracking-tight text-zinc-900 truncate">{currentTitle}</div>
            <div className="text-[11px] text-zinc-500 whitespace-nowrap">• {visibility ?? "private"}</div>
          </div>
          <div className="text-[11px] text-zinc-500 whitespace-nowrap">{edited ?? "—"}</div>
        </div>

        <div className="relative flex-1 overflow-hidden">
          <div
            className="h-full overflow-y-auto overflow-x-hidden"
            style={{ paddingBottom: dockHeight ? dockHeight + 28 : 320 }}
          >
            {isTasks ? <TasksViewport /> : <RequirementsViewport />}
            <div className="h-10" />
          </div>

          <div className="pointer-events-none absolute top-0 left-0 right-0 h-10 bg-gradient-to-b from-[#fbfbfa] to-transparent" />
          <div className="pointer-events-none absolute bottom-0 left-0 right-0 h-28 bg-gradient-to-t from-[#fbfbfa] to-transparent" />

          <div className="absolute left-0 right-0 bottom-0">
            <div className="px-8 pb-6">
              <div ref={dockRef}>
                <AiDock />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

==========================================================================================
FILE: src\contexts\DFMEAContext.jsx
==========================================================================================
import React, { createContext, useContext, useMemo, useState, useCallback } from "react";
import requirementsJson from "../data/requirements.json";
import tasksJson from "../data/tasks.json";

const DFMEAContext = createContext(null);

function uid(prefix = "id") {
  return `${prefix}-${Math.random().toString(16).slice(2)}-${Date.now().toString(16)}`;
}

export function DFMEAProvider({ children }) {
  // --- Navigation (global app state)
  const [activeTab, setActiveTab] = useState(requirementsJson?.tabId || "requirements");

  // --- Requirements (loaded from JSON, editable in-memory)
  const [requirementsData, setRequirementsData] = useState(requirementsJson);

  // --- Tasks (loaded from JSON, editable in-memory)
  const [tasksData, setTasksData] = useState(tasksJson);

  // --- Workflows placeholder (in-memory only)
  const [workflows, setWorkflows] = useState([]);
  const [selectedWorkflowId, setSelectedWorkflowId] = useState(null);

  const updateRequirement = useCallback((id, patch) => {
    setRequirementsData((prev) => {
      const reqs = prev?.content?.requirements || [];
      const next = reqs.map((r) => (r.id === id ? { ...r, ...patch } : r));
      return {
        ...prev,
        content: { ...prev.content, requirements: next },
        meta: { ...(prev.meta || {}), edited: "Just now" },
      };
    });
  }, []);

  const updateTask = useCallback((id, patch) => {
    setTasksData((prev) => {
      const tasks = prev?.tasks || [];
      const next = tasks.map((t) => (t.id === id ? { ...t, ...patch } : t));
      return {
        ...prev,
        tasks: next,
        meta: { ...(prev.meta || {}), edited: "Just now" },
      };
    });
  }, []);

  // --- Workflows placeholder actions
  const createWorkflow = useCallback(() => {
    setWorkflows((prev) => {
      const w = { id: uid("wf"), title: "Untitled" };
      return [w, ...prev];
    });
    setSelectedWorkflowId((prev) => prev || null);
  }, []);

  const deleteWorkflow = useCallback((id) => {
    setWorkflows((prev) => prev.filter((w) => w.id !== id));
    setSelectedWorkflowId((prev) => (prev === id ? null : prev));
  }, []);

  const value = useMemo(() => {
    return {
      // navigation
      activeTab,
      setActiveTab,

      // requirements
      requirementsData,
      setRequirementsData,
      updateRequirement,

      // tasks
      tasksData,
      setTasksData,
      updateTask,

      // workflows placeholder
      workflows,
      selectedWorkflowId,
      setSelectedWorkflowId,
      createWorkflow,
      deleteWorkflow,
    };
  }, [
    activeTab,
    setActiveTab,
    requirementsData,
    setRequirementsData,
    updateRequirement,
    tasksData,
    setTasksData,
    updateTask,
    workflows,
    selectedWorkflowId,
    setSelectedWorkflowId,
    createWorkflow,
    deleteWorkflow,
  ]);

  return <DFMEAContext.Provider value={value}>{children}</DFMEAContext.Provider>;
}

export function useDFMEA() {
  const ctx = useContext(DFMEAContext);
  if (!ctx) throw new Error("useDFMEA must be used inside DFMEAProvider");
  return ctx;
}
